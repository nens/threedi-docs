<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Water system &mdash; 3Di  (dev doc 2023-03-13) documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script src="_static/matomo.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Sewerage" href="d_sewerage.html" />
    <link rel="prev" title="Flood model" href="d_flood_model.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            3Di
          </a>
              <div class="version">
                 (dev doc 2023-03-13)
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="a_background.html">Background of 3Di</a></li>
<li class="toctree-l1"><a class="reference internal" href="a_ecosystem.html">3Di Ecosystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="a_modelling_concepts.html">Basic Modelling Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="a_releasenotes.html">Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="a_contact.html">Contact</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">3Di Connectors</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="b_fews_3di_integrations.html">FEWS-3Di integration</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Guide to the 3Di Modeller Interface</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="i_what_is_mi.html">What is the Modeller Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="i_overview_user_interface.html">Overview of the user Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="i_modelling_with_mi.html">Modelling with the Modeller Interface</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Guide to the 3Di Live Site</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="c_what_is_the_live_site.html">What is the live site</a></li>
<li class="toctree-l1"><a class="reference internal" href="c_what_is_the_live_site.html#using-the-3di-live-site">Using the 3Di Live Site</a></li>
<li class="toctree-l1"><a class="reference internal" href="c_livesite_overview.html">Overview of the live site</a></li>
<li class="toctree-l1"><a class="reference internal" href="c_livesite_overview.html#login-to-the-live-site">Login to the Live Site</a></li>
<li class="toctree-l1"><a class="reference internal" href="c_livesite_overview.html#overview-session-screen-and-tooling">Overview session screen and tooling</a></li>
<li class="toctree-l1"><a class="reference internal" href="c_livesite_overview.html#notables">Notables</a></li>
<li class="toctree-l1"><a class="reference internal" href="c_modelling_with_live_site.html">Modelling with the live site</a></li>
<li class="toctree-l1"><a class="reference internal" href="c_modelling_with_live_site.html#start-or-follow-a-session">Start or follow a session</a></li>
<li class="toctree-l1"><a class="reference internal" href="c_modelling_with_live_site.html#editing-a-model-schematisation-with-the-live-site">Editing a model schematisation with the live site</a></li>
<li class="toctree-l1"><a class="reference internal" href="c_modelling_with_live_site.html#simulation-interventions">Simulation interventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="c_modelling_with_live_site.html#analyzing-results-while-scenario-is-running">Analyzing results while scenario is running</a></li>
<li class="toctree-l1"><a class="reference internal" href="c_modelling_with_live_site.html#quitting-the-simulation">Quitting the simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="c_modelling_with_live_site.html#store-results">Store results</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="e_klondike_workflow.html">Tutorial 1: Workflow of creating a 3Di Schematisation and a 3Di Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="e_2d_tutorial.html">Tutorial 2: Building a Basic 2D Flow Schematisation</a></li>
<li class="toctree-l1"><a class="reference internal" href="e_2d_slope_tutorial.html">Tutorial 3: 2D flow model over sloped terrain with multiple rasters</a></li>
<li class="toctree-l1"><a class="reference internal" href="e_2d_levees_tutorial.html">Tutorial 4 Building a 2D flow model with levees, channels and breaches</a></li>
<li class="toctree-l1"><a class="reference internal" href="e_1d_tutorial.html">Tutorial 5: Building a 1D model</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Problem solving and support</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="f_3di_instruments_and_downloads.html">Installation manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="f_problem_solving.html">FAQ and Problem Solving</a></li>
<li class="toctree-l1"><a class="reference internal" href="f_servicedesk.html">Servicedesk</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Physics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="g_massconservation.html">Conservation of mass</a></li>
<li class="toctree-l1"><a class="reference internal" href="g_flow.html">Flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="g_sources_sinks.html">Source and Sink terms</a></li>
<li class="toctree-l1"><a class="reference internal" href="g_levees_obstacles_breaches.html">Obstacles, Levees and Breaches</a></li>
<li class="toctree-l1"><a class="reference internal" href="g_wind.html">Wind effects</a></li>
<li class="toctree-l1"><a class="reference internal" href="g_interception.html">Interception</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Model concepts</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="h_basic_modelling_concepts_threedi.html">Basic Modelling Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="h_grid.html">The grid</a></li>
<li class="toctree-l1"><a class="reference internal" href="h_numerics.html">Numerics</a></li>
<li class="toctree-l1"><a class="reference internal" href="h_control.html">Control Structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="h_calculation_grid_data.html">Tabulated data storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="h_results.html">Results 3Di</a></li>
<li class="toctree-l1"><a class="reference internal" href="h_aggregate_results.html">Aggregated output</a></li>
<li class="toctree-l1"><a class="reference internal" href="h_state_files.html">State files</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">3Di</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="d_modeling_components.html">Modeling components</a></li>
      <li class="breadcrumb-item active">Water system</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/d_water_system.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="water-system">
<h1>Water system<a class="headerlink" href="#water-system" title="Permalink to this heading"></a></h1>
<p>To model the water system of a polder you will need different types of structures and perhaps a larger level of detail than available in your bathymetry files. For this purpose, 3Di offers channels and structures that can be linked to the 2D computational grid. We refer to them as the 1D components. This tutorial shows you the steps needed to add these elements to an existing model.  More background information, can be found at <a class="reference internal" href="g_onedee_flow.html#onedee-flow"><span class="std std-ref">1D Flow</span></a>.</p>
<p>The first thing you must do is activate 1D flow in the global settings. Also consider the following parameters in the global or numerical settings:</p>
<ul class="simple">
<li><p>advection_1d</p></li>
<li><p>max_angle_1d_advection</p></li>
<li><p>max_degree</p></li>
<li><p>use_of_nested_newton</p></li>
</ul>
<section id="channels">
<span id="id1"></span><h2>Channels<a class="headerlink" href="#channels" title="Permalink to this heading"></a></h2>
<p>To add a channel or network of channels consider the following steps:</p>
<ol class="arabic">
<li><p>First, load these tables from the spatialite database:</p>
<blockquote>
<div><ol class="loweralpha simple">
<li><p>v2_channel (line geometry)</p></li>
<li><p>v2_connection_nodes (point geometry)</p></li>
<li><p>v2_cross_section_location (point geometry)</p></li>
<li><p>v2_cross_section_definition (no geometry)</p></li>
</ol>
</div></blockquote>
</li>
<li><p>Channels are drawn in between connection nodes, so start by adding nodes on the start and end-points of your channels. If you wish to add structures later on, make sure to add enough nodes as they are also linked between connection nodes (and thus not placed on top of channels).</p></li>
<li><p>After saving your edits in QGIS, the connection nodes id’s are filled automatically. You can fill out the other attributes of the connection nodes later on.</p></li>
<li><p>Now draw your channels from connection node to connection node. Make sure you snap the start and end-points to the connection nodes and fill out the connection_node_start_id and connection_node_end_id for every channel feature. Then fill all the attribute fields for all channels except the id’s and save your edits.</p></li>
<li><p>Every channels needs at least one cross-section. Start by adding one or multiple cross-section definitions in the table v2_cross_section_definition. You have several options to define you profile, check the <a class="reference download internal" download="" href="_downloads/84a660f75b3e8f891f1cd6c5f0b550f8/database-overview.pdf"><code class="xref download docutils literal notranslate"><span class="pre">database-overview</span></code></a> for more details. One definition can be used on multiple locations. Note that the v2_cross_section_definition id’s are filled after you save your edits.</p></li>
<li><p>You can place cross-sections on channels using the v2_cross_section_location. You may place multiple cross-sections on one channel. When placing locations, consider the following:</p>
<blockquote>
<div><ol class="loweralpha simple">
<li><p>Cross-section locations must be placed on a channel vertex. If you have no vertex available on you channel, add one.</p></li>
<li><p>Cross-section locations may not be placed on the start- or end-point of a channel</p></li>
<li><p>When placing multiple cross-section locations on one channel consider the distance between your computation points. Make sure you have sufficient computation points on your channel, to take this variations into account.</p></li>
<li><p>Refer to the correct channel id in the attribute field channel_id.</p></li>
<li><p>Refer to the correct definition in the attribute field definition_id</p></li>
<li><p>If it is a connected or double connected channel, make sure to fill in the bank_level. This is the level, that determines the exchange between the water in the channel and that on the 2D surface.</p></li>
</ol>
</div></blockquote>
</li>
</ol>
<p>After these steps your channel is complete. If you wish you can fill out the initial water level on the connection nodes. In case there are added computational points in the channel, these get the initial water level of the start connection node. Embedded channels require some additional steps, these are described below.</p>
</section>
<section id="structures">
<h2>Structures<a class="headerlink" href="#structures" title="Permalink to this heading"></a></h2>
<p>Structures in 3Di are defined as a connection between two connection nodes. 3Di supports four types of structures (<a class="reference internal" href="g_structures.html#structures"><span class="std std-ref">1D flow over structures</span></a>):</p>
<ol class="arabic simple">
<li><p>Pump station</p></li>
<li><p>Weir</p></li>
<li><p>Orifice</p></li>
<li><p>Culvert</p></li>
</ol>
<p>Check out the <a class="reference download internal" download="" href="_downloads/84a660f75b3e8f891f1cd6c5f0b550f8/database-overview.pdf"><code class="xref download docutils literal notranslate"><span class="pre">database-overview</span></code></a> for a short description of the requirements of the structure attributes.  However, here are some notes to help you:</p>
<ul class="simple">
<li><p>The shape of the weir, orifice and culvert is stored in the cross-section definition table. So make sure you have some available before you start adding these structures. (<a class="reference internal" href="g_structures.html#weir"><span class="std std-ref">Weirs and Orifices</span></a>)</p></li>
<li><p>Culverts are the only structure type that has a geometry, it is a line. This means it can be curved. The culvert length is derived from its geometry. All other structures are defined only as a link between nodes. (<a class="reference internal" href="g_structures.html#culvert"><span class="std std-ref">Culvert</span></a>)</p></li>
<li><p>To add a structure, make sure you have two connection nodes available at the ends of two channels. Fill in the correct start and end connection node id in the sqlite tables. You must work in the v2_structure table. Editing in view tables is not supported.</p></li>
<li><p>The pump station pumps from the start node to the end node. You can choose how it is controlled using the <em>type</em> attribute. (<a class="reference internal" href="g_structures.html#pump"><span class="std std-ref">Pumps</span></a>)</p></li>
<li><p>If you wish to model several structures that are only connected to each other, for instance a culvert followed by a weir. You must add a small storage area to the connection node. Normally, the storage area is derived from the cross-section of the adjoining channel, but when there is no channel connected to a connection node, it has by default no storage. So add it manually, or your model won’t work.</p></li>
<li><p>Finally, you must make sure that one of the cross-section’s reference levels near the structure is below the start, crest or invert level of the adjoining structure.</p></li>
</ul>
</section>
<section id="d-boundary-condition">
<h2>1D boundary condition<a class="headerlink" href="#d-boundary-condition" title="Permalink to this heading"></a></h2>
<p>Boundary conditions for the 1D system are placed on connection nodes. They can  be placed on connection nodes that are connected to a single isolated channel or structure, so not on an embedded or connected channel. Check the different types of boundary conditions available in the <a class="reference download internal" download="" href="_downloads/84a660f75b3e8f891f1cd6c5f0b550f8/database-overview.pdf"><code class="xref download docutils literal notranslate"><span class="pre">database-overview</span></code></a>.</p>
<p>The time series field in the spatialite database can only be filled by copy-pasting your time serie into the spatialite as QGIS does not allow you to enter a newline. You may use this example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span><span class="p">,</span><span class="mf">0.000000</span>
<span class="mi">15</span><span class="p">,</span><span class="mf">1.000000</span>
<span class="mi">30</span><span class="p">,</span><span class="mf">2.000000</span>
<span class="mi">45</span><span class="p">,</span><span class="mf">3.000000</span>
<span class="mi">60</span><span class="p">,</span><span class="mf">2.000000</span>
<span class="mi">9999</span><span class="p">,</span><span class="mf">2.000000</span>
</pre></div>
</div>
</section>
<section id="embedded-channels">
<h2>Embedded channels<a class="headerlink" href="#embedded-channels" title="Permalink to this heading"></a></h2>
<p>Embedded channels are useful when you wish to add more detailed profiles to a course raster-file. Also, they are the most efficient way to add channels since they don’t add to the number of computational points. In fact, the volume in the channel is integrated with that of the 2D computational cell. When modelling embedded channels, consider the following:</p>
<ul class="simple">
<li><p>The water level in the embedded channel is always equal to the water level in the underlaying 2D grid cell.</p></li>
<li><p>Embedded channels add extra connections between 2D grid cells, but ignore obstacles and levees.</p></li>
<li><p>Make sure the embedded channel profile always partially lays below the surface level in you DEM (you can’t have floating embedded channels).</p></li>
<li><p>Make sure no more than one channel vertice falls inside a single raster-file pixel.</p></li>
<li><p>Embedded channels only function when they connect several 2D grid cells, so make sure no embedded channel falls completely inside one 2D grid cell,</p></li>
<li><p>All connection nodes connected to an embedded channel become embedded, so make sure structures or channels of other types that are connected to these connection node cross at least one 2D grid cell boundary, and</p></li>
<li><p>Do not place boundary conditions directly on embedded channels.</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="d_flood_model.html" class="btn btn-neutral float-left" title="Flood model" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="d_sewerage.html" class="btn btn-neutral float-right" title="Sewerage" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Nelen &amp; Schuurmans.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>