<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Rasters &mdash; 3Di  (dev doc 2023-02-13) documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script src="_static/matomo.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Flood model" href="d_flood_model.html" />
    <link rel="prev" title="Modeling guidelines" href="d_modeling_guidelines.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            3Di
          </a>
              <div class="version">
                 (dev doc 2023-02-13)
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="a_background.html">Background of 3Di</a></li>
<li class="toctree-l1"><a class="reference internal" href="a_ecosystem.html">3Di Ecosystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="a_modelling_concepts.html">Basic Modelling Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="a_releasenotes.html">Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="a_contact.html">Contact</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">3Di Connectors</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="b_fews_3di_integrations.html">FEWS-3Di integration</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Guide to the 3Di Live Site</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="c_threedi_portal.html">Login to the Live Site</a></li>
<li class="toctree-l1"><a class="reference internal" href="c_threedi_portal.html#start-or-follow-a-session">Start or follow a session</a></li>
<li class="toctree-l1"><a class="reference internal" href="c_threedi_portal.html#overview-session-screen-and-tooling">Overview session screen and tooling</a></li>
<li class="toctree-l1"><a class="reference internal" href="c_threedi_portal.html#quitting-the-simulation">Quitting the simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="c_threedi_portal.html#store-results">Store results</a></li>
<li class="toctree-l1"><a class="reference internal" href="c_threedi_portal.html#notables">Notables</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">How to work with 3Di</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="d_building_a_model.html">Building and editing a model schematisation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="d_building_w_modeller_interface.html">Building and editing a model with the Modeller Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="d_schematisation_editor.html">Using the Schematisation Editor</a></li>
<li class="toctree-l2"><a class="reference internal" href="d_visualising_computational_grids.html">Visualising computational grids</a></li>
<li class="toctree-l2"><a class="reference internal" href="d_building_w_live_site.html">Editing a model schematisation with the live site</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="d_modeling_guidelines.html">Modeling guidelines</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Rasters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#raster-files">Raster-files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dem">DEM</a></li>
<li class="toctree-l4"><a class="reference internal" href="#raster-requirements">Raster requirements</a></li>
<li class="toctree-l4"><a class="reference internal" href="#using-gdal-to-check-and-edit-your-rasters">Using GDAL to check and edit your rasters</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="d_flood_model.html">Flood model</a></li>
<li class="toctree-l3"><a class="reference internal" href="d_water_system.html">Water system</a></li>
<li class="toctree-l3"><a class="reference internal" href="d_sewerage.html">Sewerage</a></li>
<li class="toctree-l3"><a class="reference internal" href="d_urban_areas.html">Hybrid Models</a></li>
<li class="toctree-l3"><a class="reference internal" href="d_control_structures.html">Control Structures</a></li>
<li class="toctree-l3"><a class="reference internal" href="d_boundary_conditions.html">Boundary Conditions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="d_checking_model_schematisation.html">Checking the model schematisation</a></li>
<li class="toctree-l1"><a class="reference internal" href="d_adding_running_scenario.html">Adding scenario information and running a simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="d_viewing_analysing_results.html">Storing, viewing and analysing results</a></li>
<li class="toctree-l1"><a class="reference internal" href="d_management.html">Manage your schematisations and models</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="e_klondike_workflow.html">Tutorial 1: Workflow of creating a 3Di Schematisation and a 3Di Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="e_2d_tutorial.html">Tutorial 2: Building a Basic 2D Flow Schematisation</a></li>
<li class="toctree-l1"><a class="reference internal" href="e_2d_slope_tutorial.html">Tutorial 3: 2D flow model over sloped terrain with multiple rasters</a></li>
<li class="toctree-l1"><a class="reference internal" href="e_2d_levees_tutorial.html">Tutorial 4 Building a 2D flow model with levees, channels and breaches</a></li>
<li class="toctree-l1"><a class="reference internal" href="e_1d_tutorial.html">Tutorial 5: Building a 1D model</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Problem solving and support</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="f_3di_instruments_and_downloads.html">Installation manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="f_problem_solving.html">FAQ and Problem Solving</a></li>
<li class="toctree-l1"><a class="reference internal" href="f_servicedesk.html">Servicedesk</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Physics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="g_massconservation.html">Conservation of mass</a></li>
<li class="toctree-l1"><a class="reference internal" href="g_flow.html">Flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="g_sources_sinks.html">Source and Sink terms</a></li>
<li class="toctree-l1"><a class="reference internal" href="g_levees_obstacles_breaches.html">Obstacles, Levees and Breaches</a></li>
<li class="toctree-l1"><a class="reference internal" href="g_wind.html">Wind effects</a></li>
<li class="toctree-l1"><a class="reference internal" href="g_interception.html">Interception</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Model concepts</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="h_basic_modelling_concepts_threedi.html">Basic Modelling Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="h_grid.html">The grid</a></li>
<li class="toctree-l1"><a class="reference internal" href="h_numerics.html">Numerics</a></li>
<li class="toctree-l1"><a class="reference internal" href="h_control.html">Control Structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="h_calculation_grid_data.html">Tabulated data storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="h_results.html">Results 3Di</a></li>
<li class="toctree-l1"><a class="reference internal" href="h_aggregate_results.html">Aggregated output</a></li>
<li class="toctree-l1"><a class="reference internal" href="h_state_files.html">State files</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">3Di</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="d_building_a_model.html">Building and editing a model schematisation</a></li>
          <li class="breadcrumb-item"><a href="d_modeling_guidelines.html">Modeling guidelines</a></li>
      <li class="breadcrumb-item active">Rasters</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/d_rasters.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="rasters">
<span id="id1"></span><h1>Rasters<a class="headerlink" href="#rasters" title="Permalink to this heading"></a></h1>
<section id="raster-files">
<h2>Raster-files<a class="headerlink" href="#raster-files" title="Permalink to this heading"></a></h2>
<p>In 3Di we can use several raster input types. 3Di uses raster-files stored in the Geo-Tiff format. 3Di knows which raster-files to use through a relative path-reference in the v2_global_settings table in the spatialite.</p>
<p>You may use any source for your raster information. Below see an example for the DEM, which is the main raster in case you want to do a simulation that includes rasters.</p>
</section>
<section id="dem">
<h2>DEM<a class="headerlink" href="#dem" title="Permalink to this heading"></a></h2>
<p>For the Digital Elevation Model (DEM) satellite or LIDAR-based information is often used. When working with crude SRTM-data for instance, it is important to derive the genuine surface level and remove any artefacts. Also, adding bathymetry information to your raster could be useful, since the satellite and LIDAR techniques are unable to <em>see</em> under water.</p>
</section>
<section id="raster-requirements">
<h2>Raster requirements<a class="headerlink" href="#raster-requirements" title="Permalink to this heading"></a></h2>
<p>How you derive your raster information is entirely up to you. 3Di rasters have to meet the following requirements:</p>
<ol class="arabic simple">
<li><p>Format GEO TIFF (.tif)</p></li>
<li><p>Projection in meters (EPSG:28992 in NL)</p></li>
<li><p>Projection complete according to OGC (check <a class="reference external" href="http://epsg.io/">epsg.io</a>)</p></li>
<li><p>Projection fits data location</p></li>
<li><p>Pixel size is square</p></li>
<li><p>NODATA = -9999</p></li>
<li><p>Type = Float32</p></li>
<li><p>All raster-files must have the same pixel size, origin, size and NODATA pixels</p></li>
<li><p>Data values must meet input types</p></li>
<li><p>Advised: Origin is rounded to pixel size precision</p></li>
</ol>
</section>
<section id="using-gdal-to-check-and-edit-your-rasters">
<h2>Using GDAL to check and edit your rasters<a class="headerlink" href="#using-gdal-to-check-and-edit-your-rasters" title="Permalink to this heading"></a></h2>
<p>There are several packages available that allow you to meet the requirements stated above. Below are some examples using GDAL.</p>
<p><em>If you are using Windows, GDAL should be installed together with QGIS and available through the OSGeo4W Shell. Try finding it through your start menu. A full list of GDAL functionalities and help can be found under the</em> <a class="reference external" href="http://www.gdal.org/gdal_utilities.html">gdal documentation</a>.</p>
<p><strong>Retrieve raster information using gdalinfo</strong></p>
<p>This example shows you how to find and retrieve the meta-information of your raster through the OSGeo4W Shell.</p>
<ul class="simple">
<li><p>Start the OSGeo4W Shell</p></li>
<li><p>Change the directory to the location of your raster file (use for example <code class="docutils literal notranslate"><span class="pre">D:</span></code> and <code class="docutils literal notranslate"><span class="pre">cd</span> <span class="pre">myfiles/mymodel/raster</span></code>)</p></li>
<li><p>Then type: <code class="docutils literal notranslate"><span class="pre">gdalinfo</span> <span class="pre">&lt;raster-file&gt;</span></code></p></li>
</ul>
<p>This will give you a list of all raster information available for your raster-file. Check whether your file meets the requirements listed above. Note that information that is not listed, is missing and must be added.</p>
<p><strong>Change raster information using gdalwarp</strong></p>
<p>To change or update your raster information you must be aware that some changes will affect your data content. For instance, updating your pixel size will require re-sampling or aggregation of your existing data.</p>
<p>We will use gdalwarp to update our raster information. This is a versatile command that enables you to re-project, aggregate and change the data type of your raster all in one command. The first example shows you how to change the NODATA value and transform it into a GeoTiff for any given raster. If you already found your raster in the OSGeo4W Shell you can use the following commands:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gdalwarp</span> <span class="o">-</span><span class="n">srcnodata</span> <span class="o">&lt;</span><span class="n">your</span><span class="o">-</span><span class="n">NODATA</span><span class="o">-</span><span class="n">value</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">dstnodata</span> <span class="o">-</span><span class="mi">9999</span> <span class="o">&lt;</span><span class="n">raster</span><span class="o">-</span><span class="n">file</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">of</span> <span class="n">Gtiff</span> <span class="n">warp_output</span><span class="o">.</span><span class="n">tif</span>
</pre></div>
</div>
<p><em>Note that the words that start with ‘-‘ are options in gdalwarp. They are followed by a parameter specific to that option. Also, if your NODATA value is specified in the raster information, you may omit the srcnodata option.</em></p>
<p>The next example sets all raster-information in one command for rasters that use the Dutch projection. It is a useful example as long as you remember how it may change the actual data in your pixels:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gdalwarp</span> <span class="o">-</span><span class="n">s_srs</span> <span class="n">EPSG</span><span class="p">:</span><span class="n">XXXX</span> <span class="o">-</span><span class="n">t_srs</span> <span class="n">EPSG</span><span class="p">:</span><span class="mi">28992</span> <span class="o">-</span><span class="n">of</span> <span class="n">Gtiff</span> <span class="o">-</span><span class="n">ot</span> <span class="n">Float32</span> <span class="o">-</span><span class="n">tap</span> <span class="o">-</span><span class="n">tr</span> <span class="mf">0.5</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">-</span><span class="n">srcnodata</span> <span class="n">XXXX</span> <span class="o">-</span><span class="n">dstnodata</span> <span class="o">-</span><span class="mi">9999</span> <span class="o">-</span><span class="n">cutline</span> <span class="n">study</span><span class="o">-</span><span class="n">area</span><span class="o">.</span><span class="n">shp</span> <span class="o">-</span><span class="n">crop_to_cutline</span> <span class="o">&lt;</span><span class="n">raster</span><span class="o">-</span><span class="n">file</span><span class="o">&gt;</span>  <span class="n">warp_output</span><span class="o">.</span><span class="n">tif</span>
</pre></div>
</div>
<p>Tip: Always use the <code class="docutils literal notranslate"><span class="pre">-tap</span></code> option to make sure all your rasters are properly aligned.</p>
<p>The example uses an extra shape-file of the study area. This is convenient when you are using several raster-files. It ensures that all raster-files you make have the same extent and NODATA pixels. You should make sure however that the shape-file’s projection matches that of your raster information. If you are not sure what any of the commands do exactly, you can check the <a class="reference external" href="http://www.gdal.org/gdal_utilities.html">gdal documentation</a> or try options separately to generate several output files and checking them with gdalinfo to see which option generates the result you want.</p>
<p><strong>Compress rasters using gdal_translate</strong></p>
<p>Once your raster meets all requirements there is one last thing to consider. 3Di is cloud-based so we advise you to compress all raster-files before uploading. The example below shows you how:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gdal_translate</span> <span class="o">-</span><span class="n">co</span> <span class="n">COMPRESS</span><span class="o">=</span><span class="n">DEFLATE</span> <span class="n">warp_output</span><span class="o">.</span><span class="n">tif</span> <span class="n">compressed</span><span class="o">.</span><span class="n">tif</span>
</pre></div>
</div>
<p>This command copies all data and information but compresses the data.</p>
<p><em>Note that we only recommend the DEFLATE compression option. Other options may give better compression or performance in certain cases, but they are not supported in 3Di.</em></p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="d_modeling_guidelines.html" class="btn btn-neutral float-left" title="Modeling guidelines" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="d_flood_model.html" class="btn btn-neutral float-right" title="Flood model" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Nelen &amp; Schuurmans.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>