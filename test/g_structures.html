<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>1D flow over structures &mdash; 3Di  (dev doc 2023-02-13) documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script src="_static/matomo.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Channel Flow" href="g_channelflow.html" />
    <link rel="prev" title="Pressurized flow" href="g_1Dpressurized.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            3Di
          </a>
              <div class="version">
                 (dev doc 2023-02-13)
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="a_background.html">Background of 3Di</a></li>
<li class="toctree-l1"><a class="reference internal" href="a_ecosystem.html">3Di Ecosystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="a_modelling_concepts.html">Basic Modelling Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="a_releasenotes.html">Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="a_contact.html">Contact</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">3Di Connectors</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="b_fews_3di_integrations.html">FEWS-3Di integration</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Guide to the 3Di Live Site</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="c_threedi_portal.html">Login to the Live Site</a></li>
<li class="toctree-l1"><a class="reference internal" href="c_threedi_portal.html#start-or-follow-a-session">Start or follow a session</a></li>
<li class="toctree-l1"><a class="reference internal" href="c_threedi_portal.html#overview-session-screen-and-tooling">Overview session screen and tooling</a></li>
<li class="toctree-l1"><a class="reference internal" href="c_threedi_portal.html#quitting-the-simulation">Quitting the simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="c_threedi_portal.html#store-results">Store results</a></li>
<li class="toctree-l1"><a class="reference internal" href="c_threedi_portal.html#notables">Notables</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">How to work with 3Di</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="d_building_a_model.html">Building and editing a model schematisation</a></li>
<li class="toctree-l1"><a class="reference internal" href="d_checking_model_schematisation.html">Checking the model schematisation</a></li>
<li class="toctree-l1"><a class="reference internal" href="d_adding_running_scenario.html">Adding scenario information and running a simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="d_viewing_analysing_results.html">Storing, viewing and analysing results</a></li>
<li class="toctree-l1"><a class="reference internal" href="d_management.html">Manage your schematisations and models</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="e_klondike_workflow.html">Tutorial 1: Workflow of creating a 3Di Schematisation and a 3Di Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="e_2d_tutorial.html">Tutorial 2: Building a Basic 2D Flow Schematisation</a></li>
<li class="toctree-l1"><a class="reference internal" href="e_2d_slope_tutorial.html">Tutorial 3: 2D flow model over sloped terrain with multiple rasters</a></li>
<li class="toctree-l1"><a class="reference internal" href="e_2d_levees_tutorial.html">Tutorial 4 Building a 2D flow model with levees, channels and breaches</a></li>
<li class="toctree-l1"><a class="reference internal" href="e_1d_tutorial.html">Tutorial 5: Building a 1D model</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Problem solving and support</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="f_3di_instruments_and_downloads.html">Installation manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="f_problem_solving.html">FAQ and Problem Solving</a></li>
<li class="toctree-l1"><a class="reference internal" href="f_servicedesk.html">Servicedesk</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Physics</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="g_massconservation.html">Conservation of mass</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="g_flow.html">Flow</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="g_surfaceflow.html">2D Surface Flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="g_interflow.html">2D Interflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="g_groundwater.html">2D Groundwater flow</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="g_onedee_flow.html">1D Flow</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="g_1dtypes.html">1D Flow</a></li>
<li class="toctree-l3"><a class="reference internal" href="g_1Dpressurized.html">Pressurized flow</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">1D flow over structures</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pumps">Pumps</a></li>
<li class="toctree-l4"><a class="reference internal" href="#weirs-and-orifices">Weirs and Orifices</a></li>
<li class="toctree-l4"><a class="reference internal" href="#culvert">Culvert</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="g_channelflow.html">Channel Flow</a></li>
<li class="toctree-l3"><a class="reference internal" href="g_sewerage.html">Pipe flow</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="g_sources_sinks.html">Source and Sink terms</a></li>
<li class="toctree-l1"><a class="reference internal" href="g_levees_obstacles_breaches.html">Obstacles, Levees and Breaches</a></li>
<li class="toctree-l1"><a class="reference internal" href="g_wind.html">Wind effects</a></li>
<li class="toctree-l1"><a class="reference internal" href="g_interception.html">Interception</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Model concepts</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="h_basic_modelling_concepts_threedi.html">Basic Modelling Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="h_grid.html">The grid</a></li>
<li class="toctree-l1"><a class="reference internal" href="h_numerics.html">Numerics</a></li>
<li class="toctree-l1"><a class="reference internal" href="h_control.html">Control Structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="h_calculation_grid_data.html">Tabulated data storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="h_results.html">Results 3Di</a></li>
<li class="toctree-l1"><a class="reference internal" href="h_aggregate_results.html">Aggregated output</a></li>
<li class="toctree-l1"><a class="reference internal" href="h_state_files.html">State files</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">3Di</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="g_flow.html">Flow</a></li>
          <li class="breadcrumb-item"><a href="g_onedee_flow.html">1D Flow</a></li>
      <li class="breadcrumb-item active">1D flow over structures</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/g_structures.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="d-flow-over-structures">
<span id="structures"></span><h1>1D flow over structures<a class="headerlink" href="#d-flow-over-structures" title="Permalink to this heading"></a></h1>
<p>Structures control the behaviour of water systems, therefore it is crucial to take these into account. 3Di recognises various types of structures, pumps, weirs, orifices and culverts. To guarantee the structures are implemented in your 3Di model, structures are defined as connections between two computational nodes, similar to channels and pipes. The sections below give an overview of the structures available in 3Di. Moreover, structures can be controled. This means that characteristics can be adjusted based on simulation results.
This can be done using the, in 3Di implemented, control functions (<a class="reference internal" href="h_control.html#control"><span class="std std-ref">Control Structures</span></a>) or by controls designed by the user via the 3Di API (<span class="xref std std-ref">apicalculations</span>).</p>
<section id="pumps">
<span id="pump"></span><h2>Pumps<a class="headerlink" href="#pumps" title="Permalink to this heading"></a></h2>
<p>Pumps in 3Di drain water from one location to another location, within or outside the model domain. The behaviour of a pump is specified by defining the start and stop levels of the pump and the pump capacity. Naturally, water cannot be drained by a pump when it is not there. In real life, pump capacities are often larger than its supply. This behaviour will be seen in your model results. However, this behaviour causes alternating water levels and discharges. This happens in real life and also in your simulations on short time scales, but will effectively not affect the behaviour of your system.
In the computational core, we can adjust the pump capacity to ensure a more balanced of the pump.
This functionality is called the pump_implicit_ratio and can be switched off or on. In default it is switched on. More about this functionality can be found in this section in the documentation: <a class="reference internal" href="h_numerics.html#matrixsolvers"><span class="std std-ref">Settings for Matrix solvers</span></a> –&gt; pump_implicit_ratio.</p>
<figure class="align-default" id="id2">
<img alt="structures_pump" src="_images/b_structures_pump.png" />
<figcaption>
<p><span class="caption-number">Fig. 57 </span><span class="caption-text">Schematic display of a pump function</span><a class="headerlink" href="#id2" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>In 3Di, users can add pumps to a schematisation via a connection node. Characteristics for pumps can be set by configuring the attributes:</p>
<ul class="simple">
<li><p>Capacity: Maximum discharge for which the pump is able to displace water from the suction node to the delivery node.</p></li>
<li><p>Start level: in case of water levels higher than the start level, the pump is switched on.</p></li>
<li><p>Lower stop level: in case of water level below the stop level, the pump is switched off. This level should be below the start level.</p></li>
<li><p>Upper stop level: in case of water levels above this level the pump is switched off as well. This is an optional value, but if it is used, it is always higher that the start level.</p></li>
<li><p>Type: Parameter to set whether the start and stop levels are defined at suction side or delivery side of the pump. [See Figure]</p></li>
</ul>
<p>There are two methods to define a pump in a 3Di schematisation:</p>
<ol class="arabic simple">
<li><p><em>Pump between two nodes</em>: A pump between two nodes drains water from the  node at suction side to the node at delivery side with the specified pump capacity. Depending on the type of pump the suction side or delivery side water levels determine the activity of the pump.</p></li>
<li><p><em>End pump</em>:  For an end pump only the suction side node needs to be specified. With no node defined for the delivery side, all water being drained by this pump. All water pumped from the model is specified in the flow_summary.log as contribution to the global water balance. The pump characteristics to be specified are the same as for a pump type with start/stop levels at suction side. Since no delivery side node is present, it is not possible to specify a pump type with start stop level at delivery side.</p></li>
</ol>
<p><strong>Pumps in combination with structure controls</strong></p>
<p>Pumps can be used in combination with controls. You can design a control that allows the water level at different or multiple locations determine the pumps behaviour, instead of purely local water levels. However, the local availability of water will always affect the pump capacity as well. As water that is not locally at the pump cannot be drained away. This is ensured by stopping the pump when the local water level is below the stop level. Your control affects the pumps’ behaviour, within the range of conditions for which the pump is designed.</p>
<p><em>Example</em></p>
<p>Given a controlled pump at location X with a stop and start level of 0.0 mNAP and 2 mNAP, respectively. The trigger for the control is the water level from location A. For higher waterlevels the pump capacity is increased. However, in case the water level at X is below 0.0 mNAP, but at A in a active range, the pump will stop. The pump can only become active again for waterlevels at X above 2.0 mNAP.</p>
</section>
<section id="weirs-and-orifices">
<span id="weir"></span><h2>Weirs and Orifices<a class="headerlink" href="#weirs-and-orifices" title="Permalink to this heading"></a></h2>
<p>Weirs are generally used to maintain and control the water level. Orifices connect two parts of channel networks. Both structures force the flow to converge strongly at the entrance and to diverge behind the structure. At the converging part of the flow, the assumption of conservation of momentum in 1D is invalid. Locally at the structure, conservation of energy is much more suited. The formulations for the flow over the weir and through the orifice are therefore based on Bernoulli’s principle. The computations of the flow of both structures follow the same reasoning. In the explanation below, the focus is on an open water rectangular weir, but similar steps are taken for structures with different open/closed cross-sections.</p>
<p>For a weir in open water the energy head balance reads:</p>
<div class="math notranslate nohighlight">
\[h_I+\frac{u_I^2}{2g}=h_{II}+a+\frac{u_{II}^2}{2g}\]</div>
<p>where <span class="math notranslate nohighlight">\(h\)</span> is the local water depth, <span class="math notranslate nohighlight">\(u\)</span> the local cross-sectionally averaged velocity, <span class="math notranslate nohighlight">\(g\)</span> the gravitational acceleration  and <span class="math notranslate nohighlight">\(a\)</span> the height of the crest. The sub-scripts refer to the flow domains, indicated in the figure below.</p>
<figure class="align-default" id="id3">
<img alt="structures_weir_short" src="_images/b_structure_weir_orifice.png" />
<figcaption>
<p><span class="caption-number">Fig. 58 </span><span class="caption-text">Illustration of short crested weir and orifice under sub- and (super-)critical conditions; a simplified view of the 1D network and a sketch of the available discretised information.</span><a class="headerlink" href="#id3" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>In case of structures with closed profiles, in the equation of the energy balance <span class="math notranslate nohighlight">\(h\)</span> is not the water depth, but the energy height. For structures having closed profiles, the transition of water depth to energy height is automatically taken care of in case the area fills with water.</p>
<p>For robustness, 3Di schematises structures as connections between two nodes, as can be seen in the third panel of the figure. This assumption implies that the water level on the location of the structure is unknown. To compute accurately the discharge over the structure, a difference is made between long crested and short crested structures. Both resulting formulations are based on Bernoulli’s principle, but for long crested structures, frictional losses are computed separately.</p>
<section id="short-crested">
<h3>Short crested<a class="headerlink" href="#short-crested" title="Permalink to this heading"></a></h3>
<p>The discharge over the structure is computed based on the effective cross-sectional area <span class="math notranslate nohighlight">\(A_{eff}\)</span> and the velocity over the structure <span class="math notranslate nohighlight">\(u_{II}\)</span>. Two states of the flow can occur over the structure: sub- and (super)-critical flow. For both states, different assumptions are valid. However, for both states it is assumed that <span class="math notranslate nohighlight">\(u_I\)</span> is negligible compared to <span class="math notranslate nohighlight">\(u_{II}\)</span>.</p>
<p>In case of (super-)critical flow, the downstream waterlevel does not affect the flow over the structure, as is the case under sub-critical conditions. The fourth panel of the figure shows the information known in a discretised world. In case the flow is critical, the water depth at the crest can be determined using the upstream waterlevel and the definition for critical flow:</p>
<div class="math notranslate nohighlight">
\[h_{cr}= \frac{2}{3}(h_I-a) = h_{II}\]</div>
<p>The critical velocity over the structure is given by:</p>
<div class="math notranslate nohighlight">
\[u_{II}= C_1 \sqrt{\frac{2}{3} g (h_I-a)}\]</div>
<p><span class="math notranslate nohighlight">\(C_1\)</span> is a loss coefficient, which can be set depending on the type and the shape of the structure itself and the entrance. The effective cross-sectional area is in this case based on the critical water depth. For a simple rectangular cross-section:</p>
<div class="math notranslate nohighlight">
\[A_{eff}= C_2 W \frac{2}{3}(h_I-a)\]</div>
<p>In which <span class="math notranslate nohighlight">\(C_2\)</span> is a loss coefficient due to contraction of the flow. For the total discharge in 3Di, the discharge under free flowing conditions is computed as:</p>
<div class="math notranslate nohighlight">
\[Q_{cr} = C_1 \sqrt{\frac{2}{3} g (h_I-a)} C_2 W \frac{2}{3}(h_I-a) = C \frac{2}{3}\sqrt{\frac{2}{3}g} (h_I-a)^{\frac{3}{2}}\]</div>
<p>Note, that the coefficients <span class="math notranslate nohighlight">\(C_1\)</span> and <span class="math notranslate nohighlight">\(C_2\)</span> are combined is the general discharge coefficient <span class="math notranslate nohighlight">\(C\)</span>, which can be set by the user.</p>
<p>In case of sub-critical flows, the waterlevel downstream of the structure is important.  Under these conditions the flow velocity over the structure is:</p>
<div class="math notranslate nohighlight">
\[u_{II}= C_1 \sqrt{2 g (h_{I}-h_{II}-a)}\]</div>
<p>To determine the depth at the crest, it is assumed that the waterlevel at the crest is equal to the waterlevel downstream. Based on that assumption, the effective cross-section becomes:</p>
<div class="math notranslate nohighlight">
\[A_{sub}= C_2 W h_{II}\]</div>
<p>Combining these equations, results in the discharge formulation.</p>
<div class="math notranslate nohighlight">
\[Q_{sub} = C_1 \sqrt{2 g (h_I-h_{II})} C_2 W h_{II}= C W \sqrt{2 g (h_I-h_{II})} h_{II}\]</div>
</section>
<section id="long-crested">
<h3>Long crested<a class="headerlink" href="#long-crested" title="Permalink to this heading"></a></h3>
<p>For longer structures, frictional effects can become important. For the so-called broad-crested weirs and orifices an extra loss-term is added to Bernoulli’s equation. The frictional losses <span class="math notranslate nohighlight">\(\Delta h_F\)</span> are computed as:</p>
<div class="math notranslate nohighlight">
\[\Delta h_F= \frac{c_f L u_{II}^2}{2 g R}\]</div>
<p>where <span class="math notranslate nohighlight">\(c_f\)</span> is the dimensionless friction coefficient, <span class="math notranslate nohighlight">\(L\)</span> the length of the structure and <span class="math notranslate nohighlight">\(R\)</span> is the hydraulic radius. The dimensionless friction coefficient can be based on either Manning or the Chézy formulation. It is also of importance that the structure length is correctly set. The computational core expects that this is the geometrical distance between the two connection nodes. The friction coefficient can be defined either by a Manning or a Chézy value.</p>
<p>An advantage of these formulations is that these do not limit the timestep during the simulation.</p>
<p>The attributes that define these structures are:</p>
<ul class="simple">
<li><p>Crest level: The crest level of the weir. In case of an orifice this could be equal to the bottom level.</p></li>
<li><p>Crest type: Selects a short or broad crested weir/orifice formulation.</p></li>
<li><p>Discharge coefficient positive/negative: The coefficient used in the discharge formulation. Depending on the flow direction the coefficients could be different.</p></li>
<li><p>Cross-section definition: This defines the cross-section of the structure.</p></li>
</ul>
</section>
</section>
<section id="culvert">
<span id="id1"></span><h2>Culvert<a class="headerlink" href="#culvert" title="Permalink to this heading"></a></h2>
<p>Culverts can connect parts of 1D networks and allow flow under roads or other obstacles. In contrast to orifices, the flow behaviour in a culvert is assumed to be determined by shape and much less dominated by entrance losses. The flow in culverts is assumed to be a pipe flow with possible changes in cross-section. Culverts can be used for longer sections of pipe-like structures and do not have to be straight. Shorter, straight culverts are best modelled as an orifice.</p>
<p>For culverts and orifices, the energy loss caused by the change in flow velocity at the entrance and exite are accounted for by 3Di. The discharge coefficients for culverts can be used to account for any additional energy loss.</p>
<p>The input parameters for culverts are similar to those for orifices, specified in the section above. Culverts use invert levels at the start and end instead of the crest level in weirs and orifices. The input parameters are all described in the spatialite database <a class="reference download internal" download="" href="_downloads/84a660f75b3e8f891f1cd6c5f0b550f8/database-overview.pdf"><code class="xref download docutils literal notranslate"><span class="pre">here</span></code></a>.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="g_1Dpressurized.html" class="btn btn-neutral float-left" title="Pressurized flow" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="g_channelflow.html" class="btn btn-neutral float-right" title="Channel Flow" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Nelen &amp; Schuurmans.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>