
Visualising computational grids
===============================

3Di builds a computational grid from schematisation data (stored in spatialite and rasters). This computational grid is stored in a "gridadmin.h5" file. You can visualize these grids in the 3Di Modeller Interface.


.. figure:: image/d_computational_grid.png

    An example of a visualised computational grid



You can also generate the computational grid from a schematisation. This is very useful to understand how the data in your schematisation is interpreted by 3Di. It answers questions like: 

- Where is each 2D cell located? 

- With which 2D cell does this channel exchange? 

- Which cell boundaries are affected by this obstacle?

- Where are potential breaches located exactly?

Computational grid from gridadmin.h5 file
-----------------------------------------
The processing algorithm "Computational grid from gridadmin.h5" reads the computational grid data from the .h5 file and writes it to GIS-layers in a GeoPackage. You can find it in the Processing Toolbox (Main Menu > Processing > Toolbox), under 3Di > Computational Grid. Choose a folder that contains a gridadmin.h5 file and an output location for the GeoPackage. Once the algorithm has been run, the layers from the GeoPackage will be added to your project. If you do not need this data anymore after closing the 3Di Modeller Interface, you can also save to a temporary file. 

Computational grid from schematisation
-----------------------------------------
The processing algorithm "Computational grid from schematisation" builds a computational grid from schematisation data (stored in spatialite and rasters). The algorithm writes this to a gridadmin.h5 file and subsequently converts that data to GIS-layers in a GeoPackage. You can find it in the Processing Toolbox (Main Menu > Processing > Toolbox), under 3Di > Computational Grid. Choose your schematisation's spatialite file and an output location for the GeoPackage. Once the algorithm has been run, the layers from the GeoPackage will be added to your project. If you do not need this data anymore after closing the 3Di Modeller Interface, you can also save to a temporary file. 

Differences between locally and server-generated grids
------------------------------------------------------
Please note that when generating the computational grid locally, some attributes will not be filled. The reason for this is that some information about the grid is generated by the routine that creates the volume tables (lookup tables that contain the relation between volume and water level, friction, etc.). This routine is run on the server, but not included in the grid building algorithm in the 3Di Modeller Interface. This applies to all attributes that are related to elevation in the 2D domain:

- Node layer: max_surface_area, bottom_level (for 2D and embedded nodes). Also note that a node's drain_level is only relevant if there is no 2D; otherwise, the exchange_level of the 1D flowline contains the relevant data. 

- Cell layer: max_surface_area, bottom_level, impervious_layer_elevation

- Flowline layer: exchange_level (for 2D en 1D/2D flowlines)

- Obstacles: exchange_level
