<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tutorial 2: Building a Basic 2D Flow Schematisation &mdash; 3Di  (dev doc 2023-04-03) documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script src="_static/matomo.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Tutorial 3: 2D flow model over sloped terrain with multiple rasters" href="e_2d_slope_tutorial.html" />
    <link rel="prev" title="Tutorial 1: Workflow of creating a 3Di Schematisation and a 3Di Model" href="e_klondike_workflow.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            3Di
          </a>
              <div class="version">
                 (dev doc 2023-04-03)
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="a_background.html">Background of 3Di</a></li>
<li class="toctree-l1"><a class="reference internal" href="a_ecosystem.html">3Di Ecosystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="a_releasenotes.html">Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="a_contact.html">Contact</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Modelling Guidelines</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="a_modelling_concepts.html">Basic Modelling Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="b_modeling_components.html">Modeling components</a></li>
<li class="toctree-l1"><a class="reference internal" href="b_modelling_workflow.html">Modelling Workflow</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Guide to the 3Di Modeller Interface</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="i_what_is_mi.html">What is the Modeller Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="i_overview_user_interface.html">Overview of the Modeller Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="i_overview_user_interface.html#overview-plugins">Overview plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="i_modelling_with_mi.html">Modelling with the Modeller Interface</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Guide to the 3Di Live Site</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="c_what_is_the_live_site.html">What is the Live Site</a></li>
<li class="toctree-l1"><a class="reference internal" href="c_livesite_overview.html">Overview of the Live Site</a></li>
<li class="toctree-l1"><a class="reference internal" href="c_modelling_with_live_site.html">Modelling with the Live Site</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Guide to the 3Di Management Portal</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="d_management.html">What is the Management Portal</a></li>
<li class="toctree-l1"><a class="reference internal" href="d_management.html#overview-management-portal">Overview management portal</a></li>
<li class="toctree-l1"><a class="reference internal" href="d_overview_management_portal.html">How to use the Management Portal</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">3Di for developers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="j_api.html">3Di API</a></li>
<li class="toctree-l1"><a class="reference internal" href="j_threedigrid.html">3Di Results API</a></li>
<li class="toctree-l1"><a class="reference internal" href="j_fews_3di_integrations.html">FEWS-3Di integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="j_lizard_api.html">Lizard API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="e_klondike_workflow.html">Tutorial 1: Workflow of creating a 3Di Schematisation and a 3Di Model</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tutorial 2: Building a Basic 2D Flow Schematisation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#building-the-schematisation">Building the Schematisation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#creating-a-new-schematisation">Creating a new Schematisation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#setting-up-your-qgis-project">Setting up your QGIS project</a></li>
<li class="toctree-l3"><a class="reference internal" href="#set-up-your-schematisation-settings">Set up your Schematisation settings</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#complete-the-global-settings">Complete the global settings</a></li>
<li class="toctree-l4"><a class="reference internal" href="#complete-the-infiltration-settings">Complete the infiltration settings</a></li>
<li class="toctree-l4"><a class="reference internal" href="#complete-the-aggregation-settings">Complete the aggregation settings</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#complete-the-numerical-settings">Complete the numerical settings</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#validate-and-upload-your-schematisation-generate-a-3di-model">Validate and upload your Schematisation &amp; Generate a 3Di Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#run-your-3di-model-on-the-livesite">Run your 3Di Model on the Livesite</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="e_2d_slope_tutorial.html">Tutorial 3: 2D flow model over sloped terrain with multiple rasters</a></li>
<li class="toctree-l1"><a class="reference internal" href="e_2d_levees_tutorial.html">Tutorial 4 Building a 2D flow model with levees, channels and breaches</a></li>
<li class="toctree-l1"><a class="reference internal" href="e_1d_tutorial.html">Tutorial 5: Building a 1D model</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Problem solving and support</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="f_3di_instruments_and_downloads.html">Installation manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="f_authentication_user_management.html">Authentication and User Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="f_problem_solving.html">FAQ and Problem Solving</a></li>
<li class="toctree-l1"><a class="reference internal" href="f_servicedesk.html">Servicedesk</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Physics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="g_massconservation.html">Conservation of mass</a></li>
<li class="toctree-l1"><a class="reference internal" href="g_flow.html">Flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="g_sources_sinks.html">Source and Sink terms</a></li>
<li class="toctree-l1"><a class="reference internal" href="g_levees_obstacles_breaches.html">Obstacles, Levees and Breaches</a></li>
<li class="toctree-l1"><a class="reference internal" href="g_wind.html">Wind effects</a></li>
<li class="toctree-l1"><a class="reference internal" href="g_interception.html">Interception</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Model concepts</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="h_basic_modelling_concepts_threedi.html">Basic Modelling Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="h_grid.html">The grid</a></li>
<li class="toctree-l1"><a class="reference internal" href="h_numerics.html">Numerics</a></li>
<li class="toctree-l1"><a class="reference internal" href="h_control.html">Control Structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="h_calculation_grid_data.html">Tabulated data storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="h_results.html">Results 3Di</a></li>
<li class="toctree-l1"><a class="reference internal" href="h_aggregate_results.html">Aggregated output</a></li>
<li class="toctree-l1"><a class="reference internal" href="h_state_files.html">State files</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Overig</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="d_scenario_archive.html">Scenario Archive</a></li>
<li class="toctree-l1"><a class="reference internal" href="d_scenario_archive.html#view-stored-results">View stored results</a></li>
<li class="toctree-l1"><a class="reference internal" href="d_scenario_archive.html#damage-estimation">Damage Estimation</a></li>
<li class="toctree-l1"><a class="reference internal" href="d_scenario_archive.html#load-rasters-in-3di-modeller-interface-using-wms">Load rasters in 3Di Modeller Interface using WMS</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">3Di</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Tutorial 2: Building a Basic 2D Flow Schematisation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/e_2d_tutorial.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="tutorial-2-building-a-basic-2d-flow-schematisation">
<span id="tutorial2-2dflatmodel"></span><h1>Tutorial 2: Building a Basic 2D Flow Schematisation<a class="headerlink" href="#tutorial-2-building-a-basic-2d-flow-schematisation" title="Permalink to this heading"></a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading"></a></h2>
<p>In this tutorial, you will build a schematisation to model basic 2D flow in 3Di.
We will start from scratch with an empty sqlite and build a schematisation step by step.
The final product will be a working 3Di model that can be used on the 3Di Live site.
The schematisation will be a representation of the Laugharne and Pendine Burrows, which are located in Carmarthenshire (Wales).
The burrows enclose a flat area of reclaimed salt marshes that are currently used as farmland.
Although the schematisation represents a real-world area, some processes will be simplified for the sake of this tutorial. Please keep this in mind while analysing the results of your simulations.</p>
<p><strong>In this tutorial you will</strong>:</p>
<ul class="simple">
<li><p>Re-practice <a class="reference internal" href="e_klondike_workflow.html#tutorial1-workflow"><span class="std std-ref">the workflow of creating a new schematisation</span></a>.</p></li>
<li><p>Couple a digital elevation model (DEM) to your schematisation.</p></li>
<li><p>Configure the settings of a 2D model.</p></li>
<li><p>Validate your model input with the raster checker.</p></li>
<li><p>Validate your model schematization with the schematization checker.</p></li>
<li><p>Generate a 3Di Model and play with it on the 3Di Livesite.</p></li>
</ul>
<p><strong>Before you start, please make sure to</strong>:</p>
<ul>
<li><p>Install the 3Di Modeller Interface. Please see <a class="reference internal" href="f_3di_instruments_and_downloads.html#di-instruments-and-downloads"><span class="std std-ref">Installation manual</span></a> for instructions.</p></li>
<li><p>Install the 3Di toolbox in the Modeller Interface. Please see <a class="reference internal" href="f_3di_instruments_and_downloads.html#plugin-installation"><span class="std std-ref">Plugin Installation</span></a> for instructions.</p></li>
<li><p>Gain access to the 3Di Live Site. Please see <a class="reference internal" href="c_what_is_the_live_site.html#guide-to-portal"><span class="std std-ref">Technical setup</span></a> for instructions.</p></li>
<li><p>Download the Taf <a class="reference external" href="https://nens.lizard.net/media/3di-tutorials/3di-2d_flow_tutorial.zip">dataset</a> , which contains a digital elevation model (DEM) of the Laugharne and Pendine Burrows called dem_2m_LPB.tif and an empty .sqlite database, which can be ignored.</p>
<blockquote>
<div><p><sub>The digital elevation model contains United Kingdom public sector information licensed under the Open Government Licence v2.0.</sub></p>
</div></blockquote>
</li>
</ul>
</section>
<section id="building-the-schematisation">
<h2>Building the Schematisation<a class="headerlink" href="#building-the-schematisation" title="Permalink to this heading"></a></h2>
<section id="creating-a-new-schematisation">
<h3>Creating a new Schematisation<a class="headerlink" href="#creating-a-new-schematisation" title="Permalink to this heading"></a></h3>
<p>As we are building a schematisation from scratch, the workflow explained in <a class="reference internal" href="e_klondike_workflow.html#tutorial1-workflow"><span class="std std-ref">Tutorial 1</span></a> will be used to initialize a new schematisation.
If you haven’t followed this tutorial yet, please do so before continuing this tutorial.</p>
<p>Name your newly created schematisation <strong>‘Tutorial2_&lt;your_name&gt;’</strong>, select the correct organisation and check the ‘Create new Spatialite’ box.
Press the ‘Next’ button twice and fill in the data as provided in <a class="reference internal" href="#schem-settings"><span class="std std-numref">Fig. 31</span></a>. Select your downloaded DEM .tif file for the Digital elevation model field.</p>
<figure class="align-default" id="schem-settings">
<img alt="Initial Schematisation settings." src="_images/e_schematisation_settings.png" />
<figcaption>
<p><span class="caption-number">Fig. 31 </span><span class="caption-text">Initial Schematisation settings</span><a class="headerlink" href="#schem-settings" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="setting-up-your-qgis-project">
<h3>Setting up your QGIS project<a class="headerlink" href="#setting-up-your-qgis-project" title="Permalink to this heading"></a></h3>
<p>When your schematisation has successfully been generated, it can be added to your QGIS project. During this process, you might get a warning prompt on an outdated database schema version. If so, select <strong>Yes</strong>.
Your spatialite should now be visible in your Layers panel.</p>
<p>It is convenient (but not required) to add the DEM to your project as well.
This is simply done by navigating to the folder of your schematisation, navigate to ‘work in progress’&gt;’schematisation’&gt;’rasters’ and finally drag your DEM file into your QGIS project.
Please make sure that you use the DEM file from your project folder in stead of your download folder. Changes made to your DEM file will not be tracked if you use the wrong file.</p>
<p>Another way to make building your schematisation visually easier is to add a background. A good option would be the Google Satellite background map:</p>
<ol class="loweralpha simple">
<li><p>In your browser panel, right-click on “XYZ Tiles” and select “new connection”. If the browser panel is not visible in your 3Di modeller interface, select “view” &gt; “panels” &gt; “browser panel” from the top menu bar. [1]</p></li>
<li><p>Fill in Name as “Google Satellite” and URL as <code class="docutils literal notranslate"><span class="pre">https://mt1.google.com/vt/lyrs=s&amp;x={x}&amp;y={y}&amp;z={z}</span></code>. [2]</p></li>
<li><p>Select “OK”. The Google Satellite layer should now be visible in your browser panel. You may need to click the small triangle to the left of “XYZ tiles” if the layer does not become immediately visible. [3]</p></li>
<li><p>Double-click the Google Satellite layer to load it into your project. [4]</p></li>
<li><p>Reorder the layers such that the Google Satellite layer is below the 3Di model. This will ensure the visibility of the model components at later stages. [5]</p></li>
</ol>
<p>Lastly, it is advised to set your project reference to EPSG:27700 (British National Grid) for this tutorial.
This can be done in the bottom right of your QGIS/MI window.</p>
<p>Your QGIS project should now look like this:</p>
<figure class="align-default" id="qgis-setup">
<img alt="QGIS project setup." src="_images/e_qgis-project.png" />
<figcaption>
<p><span class="caption-number">Fig. 32 </span><span class="caption-text">The proposed setup of your QGIS project including i) your Spatialite loaded, ii) the DEM added, iii) a background layer, and iv) a projection of 27700.</span><a class="headerlink" href="#qgis-setup" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="set-up-your-schematisation-settings">
<h3>Set up your Schematisation settings<a class="headerlink" href="#set-up-your-schematisation-settings" title="Permalink to this heading"></a></h3>
<p>The most fundamental element to building a schematisation is choosing your correct settings.
We will go through all required settings for a basic 2D flow model. A list of mandatory settings and detailed descriptions can be found <a class="reference download internal" download="" href="_downloads/84a660f75b3e8f891f1cd6c5f0b550f8/database-overview.pdf"><code class="xref download docutils literal notranslate"><span class="pre">in</span> <span class="pre">the</span> <span class="pre">database</span> <span class="pre">overview</span></code></a>.
Extra elements, such as 1D channels, levees or hydraulic structures, are discussed in the other tutorials.</p>
<section id="complete-the-global-settings">
<h4>Complete the global settings<a class="headerlink" href="#complete-the-global-settings" title="Permalink to this heading"></a></h4>
<p>The global settings are found in the v2_global_settings table. Open the settings by</p>
<ol class="upperalpha simple">
<li><p>Right-click the v2_global_settings table. [1]</p></li>
<li><p>Select <strong>Open attribute table</strong>. [2]</p></li>
</ol>
<figure class="align-default">
<img alt="Global settings" src="_images/03_global_settings.png" />
</figure>
<ol class="upperalpha simple" start="3">
<li><p>Select <strong>Switch to form view</strong> in the bottom right corner. [1]</p></li>
<li><p>Select <strong>Toggle editing mode</strong> and in the top right corner. [2]</p></li>
</ol>
<figure class="align-default">
<img alt="Toggle editing" src="_images/04_toggle_editing2.png" />
</figure>
<p>Now everything is set up to configure the global settings.
3Di requires you to complete all mandatory settings before changes can be saved. These are recognized by the orange color when not filled in.
For an overview of the mandatory settings, checkout the <a class="reference download internal" download="" href="_downloads/84a660f75b3e8f891f1cd6c5f0b550f8/database-overview.pdf"><code class="xref download docutils literal notranslate"><span class="pre">database</span> <span class="pre">overview</span> <span class="pre">pdf</span></code></a>.
Attempts to save the settings before all mandatory field have been completed will result in an error message.</p>
<p>The settings that we will use for the 2D flow simulations in the Laugharne and Pendine Burrows Model are as follows (some settings allready have been filled in due to the settings that you have set during the Schematisation creation):</p>
<table class="docutils align-default" id="id1">
<caption><span class="caption-number">Table 4 </span><span class="caption-text">General</span><a class="headerlink" href="#id1" title="Permalink to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Setting</p></th>
<th class="head"><p>Value for this tutorial</p></th>
<th class="head"><p>Comments</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>id</p></td>
<td><p>1</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>name</p></td>
<td><p>Tutorial_2D_flow</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>use_0d_inflow</p></td>
<td><p>0: do not use 0d inflow</p></td>
<td><p>Use only when point sources are present</p></td>
</tr>
<tr class="row-odd"><td><p>use_1d_flow</p></td>
<td><p>No</p></td>
<td><p>This tutorial does not define 1D channels</p></td>
</tr>
<tr class="row-even"><td><p>use_2d_rain</p></td>
<td><p>Yes</p></td>
<td><p>Enables rainfall</p></td>
</tr>
<tr class="row-odd"><td><p>use_2d_flow</p></td>
<td><p>Yes</p></td>
<td><p>Enables 2D flow</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default" id="id2">
<caption><span class="caption-number">Table 5 </span><span class="caption-text">Grid</span><a class="headerlink" href="#id2" title="Permalink to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Setting</p></th>
<th class="head"><p>Value for this tutorial</p></th>
<th class="head"><p>Comments</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>grid_space</p></td>
<td><p>64</p></td>
<td><p>Minimum grid cell size in metres</p></td>
</tr>
<tr class="row-odd"><td><p>kmax</p></td>
<td><p>1</p></td>
<td><p>See <a class="reference internal" href="d_flood_model.html#computational-grid"><span class="std std-ref">Computational grid</span></a></p></td>
</tr>
<tr class="row-even"><td><p>table_step_size</p></td>
<td><p>0.10</p></td>
<td><p>See <a class="reference internal" href="d_flood_model.html#computational-grid"><span class="std std-ref">Computational grid</span></a></p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default" id="id3">
<caption><span class="caption-number">Table 6 </span><span class="caption-text">Terrain information</span><a class="headerlink" href="#id3" title="Permalink to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Setting</p></th>
<th class="head"><p>Value for this tutorial</p></th>
<th class="head"><p>Comments</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>dem_file</p></td>
<td><p>rasters/dem_2m_LPB.tif</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>epsg_code</p></td>
<td><p>27700</p></td>
<td><p>British national grid</p></td>
</tr>
<tr class="row-even"><td><p>frict_coef_file</p></td>
<td><p>NULL</p></td>
<td><p>Only used for spatially varying friction</p></td>
</tr>
<tr class="row-odd"><td><p>frict_coef</p></td>
<td><p>0.06</p></td>
<td><p>Farmland</p></td>
</tr>
<tr class="row-even"><td><p>frict_type</p></td>
<td><p>2: Manning</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>frict_avg</p></td>
<td><p>No</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>initial_groundwater_level_file</p></td>
<td><p>NULL</p></td>
<td><p>No groundwater</p></td>
</tr>
<tr class="row-odd"><td><p>initial_groundwater_level</p></td>
<td><p>NULL</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>initial_groundwater_level_type</p></td>
<td><p>(NULL)</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>initial_waterlevel_file</p></td>
<td><p>NULL</p></td>
<td><p>Only for spatially varying initial water level</p></td>
</tr>
<tr class="row-even"><td><p>initial_waterlevel</p></td>
<td><p>-10</p></td>
<td><p>in metres; selected for a dry start</p></td>
</tr>
<tr class="row-odd"><td><p>water_level_ini_type</p></td>
<td><p>max</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>interception_file</p></td>
<td><p>NULL</p></td>
<td><p>No interception</p></td>
</tr>
<tr class="row-odd"><td><p>interception_global</p></td>
<td><p>NULL</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>wind_shielding_file</p></td>
<td><p>NULL</p></td>
<td><p>No wind</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default" id="id4">
<caption><span class="caption-number">Table 7 </span><span class="caption-text">Time</span><a class="headerlink" href="#id4" title="Permalink to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Setting</p></th>
<th class="head"><p>Value for this tutorial</p></th>
<th class="head"><p>Comments</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>start_date</p></td>
<td><p>2020-01-01</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>start_time</p></td>
<td><p>2020-01-01 00:00:00</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>sim_time_step</p></td>
<td><p>30</p></td>
<td><p>in seconds</p></td>
</tr>
<tr class="row-odd"><td><p>timestep_plus</p></td>
<td><p>No</p></td>
<td><p>Only when extra control over the timestep is required</p></td>
</tr>
<tr class="row-even"><td><p>minimum_sim_time_step</p></td>
<td><p>0.01</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>maximum_sim_time_step</p></td>
<td><p>30</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>nr_timesteps</p></td>
<td><p>240</p></td>
<td><p>for a 2 hour simulation</p></td>
</tr>
<tr class="row-odd"><td><p>output_time_step</p></td>
<td><p>120</p></td>
<td><p>in seconds</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default" id="id5">
<caption><span class="caption-number">Table 8 </span><span class="caption-text">Setting id’s</span><a class="headerlink" href="#id5" title="Permalink to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Setting</p></th>
<th class="head"><p>Value for this tutorial</p></th>
<th class="head"><p>Comments</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>interflow_settings_id</p></td>
<td><p>NULL</p></td>
<td><p>No interflow</p></td>
</tr>
<tr class="row-odd"><td><p>groundwater_settings_id</p></td>
<td><p>NULL</p></td>
<td><p>No groundwater</p></td>
</tr>
<tr class="row-even"><td><p>numerical_settings_id</p></td>
<td><p>1</p></td>
<td><p>Reference to the model specific numerical settings</p></td>
</tr>
<tr class="row-odd"><td><p>simple_infiltration_settings_id</p></td>
<td><p>1</p></td>
<td><p>Reference to the model specific infiltration settings</p></td>
</tr>
<tr class="row-even"><td><p>control_group_id</p></td>
<td><p>NULL</p></td>
<td><p>No control groups</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default" id="id6">
<caption><span class="caption-number">Table 9 </span><span class="caption-text">Extra options 1D (not relevant as this tutorial does not contain 1D elements)</span><a class="headerlink" href="#id6" title="Permalink to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Setting</p></th>
<th class="head"><p>Value for this tutorial</p></th>
<th class="head"><p>Comments</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>advection_1d</p></td>
<td><p>0: Do not use advection 1d</p></td>
<td><p>No 1D elements</p></td>
</tr>
<tr class="row-odd"><td><p>dist_calc_points</p></td>
<td><p>10000</p></td>
<td><p>No 1D elements</p></td>
</tr>
<tr class="row-even"><td><p>manhole_storage_area</p></td>
<td><p>NULL</p></td>
<td><p>No 1D elements</p></td>
</tr>
<tr class="row-odd"><td><p>max_angle_1d_advection</p></td>
<td><p>NULL</p></td>
<td><p>No 1D elements</p></td>
</tr>
<tr class="row-even"><td><p>table_step_size_1d</p></td>
<td><p>NULL</p></td>
<td><p>No 1D elements</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default" id="id7">
<caption><span class="caption-number">Table 10 </span><span class="caption-text">Extra options 2D</span><a class="headerlink" href="#id7" title="Permalink to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Setting</p></th>
<th class="head"><p>Value for this tutorial</p></th>
<th class="head"><p>Comments</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>advection_2d</p></td>
<td><p>1: Use advection 2d</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>dem_obstacle_detection</p></td>
<td><p>No</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>guess_dams</p></td>
<td><p>No</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>dem_obstacle_height</p></td>
<td><p>NULL</p></td>
<td><p>Obstacles not activated</p></td>
</tr>
<tr class="row-even"><td><p>embedded_cutoff_threshold</p></td>
<td><p>NULL</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>flooding_threshold</p></td>
<td><p>1e-06</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>table_step_size_volume_2d</p></td>
<td><p>NULL</p></td>
<td></td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Do not forget to save your changes after completing all settings, by clicking on <strong>save edits</strong> in the top left corner.</p>
</div>
</section>
<section id="complete-the-infiltration-settings">
<h4>Complete the infiltration settings<a class="headerlink" href="#complete-the-infiltration-settings" title="Permalink to this heading"></a></h4>
<p>The settings for the infiltration mechanism are contained in the v2_simple_infiltration table, which can be found just above the global settings.
Right-click again to open the Attribute Table [1], toggle editing [2], add a new feature [3] and start editing the settings to the provided values in <a class="reference internal" href="#inf-settings"><span class="std std-numref">Table 11</span></a>.</p>
<img alt="infiltration" src="_images/05_infiltration.png" />
<p>Editing the table work in a similar manner as with the v2_global_settings table. Complete the following settings:</p>
<table class="docutils align-default" id="inf-settings">
<caption><span class="caption-number">Table 11 </span><span class="caption-text">General</span><a class="headerlink" href="#inf-settings" title="Permalink to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Setting</p></th>
<th class="head"><p>Value for this tutorial</p></th>
<th class="head"><p>Comments</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>id</p></td>
<td><p>1</p></td>
<td><p>Must match the simple_infiltration_settings_id in the v2_global_settings_table</p></td>
</tr>
<tr class="row-odd"><td><p>display_name</p></td>
<td><p>infiltration</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>infiltration_rate</p></td>
<td><p>360</p></td>
<td><p>in mm/hour; uniform silty sand is assumed in this tutorial</p></td>
</tr>
<tr class="row-odd"><td><p>infiltration_rate_file</p></td>
<td><p>NULL</p></td>
<td><p>Only used for spatially varying infiltration rates</p></td>
</tr>
<tr class="row-even"><td><p>max_infiltration_capacity_file</p></td>
<td><p>NULL</p></td>
<td><p>infinite infiltration capacity is assumed in this tutorial</p></td>
</tr>
<tr class="row-odd"><td><p>infiltration_surface_option</p></td>
<td><p>0</p></td>
<td><p>See <a class="reference internal" href="g_infiltration.html#infiltration"><span class="std std-ref">Infiltration</span></a></p></td>
</tr>
</tbody>
</table>
</section>
<section id="complete-the-aggregation-settings">
<h4>Complete the aggregation settings<a class="headerlink" href="#complete-the-aggregation-settings" title="Permalink to this heading"></a></h4>
<p>The aggregation settings control the aggregation of model results.
They are contained in the v2_aggregation_settings table.</p>
<p>As with the previous settings, open the attribute table, toggle the editing mode and add a feature. However, select <strong>switch to table view</strong> this time.</p>
<img alt="Aggregation Settings update" src="_images/07_v2_aggregation2.png" />
<p>The different rows of the table refer to different model output categories.
For each category, set the global_settings_id at 1 if this is not the case yet. You can either do this manually by filling in 1’s in the column [1], or by:</p>
<ol class="upperalpha simple">
<li><p>Selecting the column global_settings_id in the drop down menu [2]</p></li>
<li><p>Typing a 1 in the bar [3]</p></li>
<li><p>Clicking <strong>update All</strong> [4]</p></li>
<li><p>And pressing <strong>save edits</strong> [5]</p></li>
</ol>
<p>Retain the default values for all other settings.</p>
</section>
</section>
<section id="complete-the-numerical-settings">
<h3>Complete the numerical settings<a class="headerlink" href="#complete-the-numerical-settings" title="Permalink to this heading"></a></h3>
<p>The numerical settings are contained in the v2_numerical_settings table which can be found under advanced numerics.</p>
<img alt="Numerical settings" src="_images/06_numerical.png" />
<p>As with the previous settings, open the attribute table, toggle the editing mode, switch to form view and add a feature if the settings do not yet contain one.
Change the settings, where required, to the following values:</p>
<table class="docutils align-default" id="id8">
<caption><span class="caption-number">Table 12 </span><span class="caption-text">General</span><a class="headerlink" href="#id8" title="Permalink to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Setting</p></th>
<th class="head"><p>Value for this tutorial</p></th>
<th class="head"><p>Comments</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>id</p></td>
<td><p>1</p></td>
<td><p>Must match the numerical_settings_id in the v2_global_settings_table</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default" id="id9">
<caption><span class="caption-number">Table 13 </span><span class="caption-text">Limiters (not used in this tutorial, only for sloping areas)</span><a class="headerlink" href="#id9" title="Permalink to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Setting</p></th>
<th class="head"><p>Value for this tutorial</p></th>
<th class="head"><p>Comments</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>limiter_grad_1d</p></td>
<td><p>1</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>limiter_grad_2d</p></td>
<td><p>0</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>limiter_slope_crossectional_area_2d</p></td>
<td><p>0</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>limiter_slope_friction_2d</p></td>
<td><p>0</p></td>
<td></td>
</tr>
</tbody>
</table>
<table class="docutils align-default" id="id10">
<caption><span class="caption-number">Table 14 </span><span class="caption-text">Matrix</span><a class="headerlink" href="#id10" title="Permalink to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Setting</p></th>
<th class="head"><p>Value for this tutorial</p></th>
<th class="head"><p>Comments</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>convergence_cg</p></td>
<td><p>1e-09</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>convergence_eps</p></td>
<td><p>1e-05</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>use_of_cg</p></td>
<td><p>20</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>use_of_nested_newton</p></td>
<td><p>0: when the schematisation does not include 1D-elements …</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>max_degree</p></td>
<td><p>5: for surface flow only</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>max_nonlin_iterations</p></td>
<td><p>20</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>precon_cg</p></td>
<td><p>1</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>integration_method</p></td>
<td><p>0</p></td>
<td></td>
</tr>
</tbody>
</table>
<table class="docutils align-default" id="id11">
<caption><span class="caption-number">Table 15 </span><span class="caption-text">Thresholds</span><a class="headerlink" href="#id11" title="Permalink to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Setting</p></th>
<th class="head"><p>Value for this tutorial</p></th>
<th class="head"><p>Comments</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>flow_direction_threshold</p></td>
<td><p>1e-06</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>general_numerical_threshold</p></td>
<td><p>1e-08</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>thin_water_layer_definition</p></td>
<td><p>0.05</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>minimum_friction_velocity</p></td>
<td><p>0.05</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>minimum_surface_area</p></td>
<td><p>1e-08</p></td>
<td></td>
</tr>
</tbody>
</table>
<table class="docutils align-default" id="id12">
<caption><span class="caption-number">Table 16 </span><span class="caption-text">Miscellaneous</span><a class="headerlink" href="#id12" title="Permalink to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Setting</p></th>
<th class="head"><p>Value for this tutorial</p></th>
<th class="head"><p>Comments</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>cfl_strictness_factor_1d</p></td>
<td><p>1</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>cfl_strictness_factor_2d</p></td>
<td><p>1</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>frict_shallow_water_correction</p></td>
<td><p>0</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>pump_implicit_ratio</p></td>
<td><p>1</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>preissmann_slot</p></td>
<td><p>0</p></td>
<td></td>
</tr>
</tbody>
</table>
<p>All the settings should now be up to date, which means you are good to go validate and upload your Schematisation.</p>
</section>
</section>
<section id="validate-and-upload-your-schematisation-generate-a-3di-model">
<h2>Validate and upload your Schematisation &amp; Generate a 3Di Model<a class="headerlink" href="#validate-and-upload-your-schematisation-generate-a-3di-model" title="Permalink to this heading"></a></h2>
<p>Following the basic workflow (explained in <a class="reference internal" href="e_klondike_workflow.html#tutorial1-workflow"><span class="std std-ref">Tutorial 1</span></a>), we are now checking the Schematisation, uploading it to the 3Di Management screens and generate a 3Di model by:</p>
<ol class="arabic simple">
<li><p>Pressing the Upload button in the Models &amp; Simulations plugin.</p></li>
<li><p>Clicking the New Upload button, followed by the Next button.</p></li>
<li><p>Clicking the Check Schematisation button. This should result in no errors. If you did get a warning or error, please thoroughly check the preceding steps. Otherwise, click Next.</p></li>
<li><p>Select Upload for the Spatialite and Terrain Model, fill in a commit message such as “First Commit Tutorial 2 &lt;name&gt;”, select UPLOAD AND PROCESS and click the Start Upload button.</p></li>
</ol>
<p>After waiting for about 2 minutes, you should see the following window:</p>
<figure class="align-default">
<img alt="successfull schematisation upload." src="_images/e_schem_upload_success.png" />
</figure>
</section>
<section id="run-your-3di-model-on-the-livesite">
<h2>Run your 3Di Model on the Livesite<a class="headerlink" href="#run-your-3di-model-on-the-livesite" title="Permalink to this heading"></a></h2>
<p>You can now find your 3Di Model via the <a class="reference external" href="https://www.3di.live/">3Di Live Site</a> or via the 3Di Modeller Interface and use it for simulations. The Schematisation can also be found in the <a class="reference external" href="https://management.3di.live/">Management screens</a>.</p>
<img alt="Live calculation in the live site" src="_images/17_livesite2.png" />
<p>You have now successfully build a 2D flow model Schematisation from scratch!</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="e_klondike_workflow.html" class="btn btn-neutral float-left" title="Tutorial 1: Workflow of creating a 3Di Schematisation and a 3Di Model" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="e_2d_slope_tutorial.html" class="btn btn-neutral float-right" title="Tutorial 3: 2D flow model over sloped terrain with multiple rasters" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Nelen &amp; Schuurmans.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>